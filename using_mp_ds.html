

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multiprocessing and Distributed Systems &mdash; Creamas 0.4.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Documentation" href="api.html" />
    <link rel="prev" title="Using Simulation" href="create_sim.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Creamas
          

          
          </a>

          
            
            
              <div class="version">
                0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_agent.html">Implementing Agent Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_sim.html">Using Simulation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multiprocessing and Distributed Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#support-for-multiple-cores">Support for Multiple Cores</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#slave-environments-and-managers">Slave Environments and Managers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#managing-functions">Managing Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-between-master-and-slaves">Communication Between Master and Slaves</a></li>
<li class="toctree-l3"><a class="reference internal" href="#developing-for-multiple-cores">Developing for Multiple Cores</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#support-for-distributed-systems">Support for Distributed Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-a-distributed-environment">Using a Distributed Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spawning-nodes">Spawning Nodes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Creamas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Multiprocessing and Distributed Systems</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/using_mp_ds.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multiprocessing-and-distributed-systems">
<h1>Multiprocessing and Distributed Systems<a class="headerlink" href="#multiprocessing-and-distributed-systems" title="Permalink to this headline">¶</a></h1>
<p>Creamas has builtin basic support for agent environments running on multiple
cores (see <a class="reference internal" href="mp.html"><span class="doc">Multiprocessing functionality</span></a>) and agent environments set up on distributed systems
(see <a class="reference internal" href="ds.html"><span class="doc">Distributed Systems</span></a>), e.g. computing clusters. In this section, we explain the
basic architectural concepts required to understand how to build your own
multiprocessing and distributed environments. You should be familiar with
basic overview of the library before venturing forth (see <a class="reference internal" href="overview.html"><span class="doc">Overview</span></a>).</p>
<p>Next, we first go over multiprocessing implementation of the basic environment,
<a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>, and then the distributed system
implementation, <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a>.</p>
<div class="section" id="support-for-multiple-cores">
<h2>Support for Multiple Cores<a class="headerlink" href="#support-for-multiple-cores" title="Permalink to this headline">¶</a></h2>
<p>Multiprocessing support in Creamas is built around
<a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>. This class spawns a set of
<a class="reference internal" href="environment.html#creamas.core.environment.Environment" title="creamas.core.environment.Environment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Environment</span></code></a> slaves in their own subprocesses
and acts as
a master for them. The master environment has also its own instance of
<a class="reference internal" href="environment.html#creamas.core.environment.Environment" title="creamas.core.environment.Environment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Environment</span></code></a> which is used to communicate
with the slaves, but because it does not contain any agents (other than
a possible manager agent, as we will see when dealing with distributed systems),
we will not distinguish it from the <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> for
the time being.</p>
<div class="section" id="slave-environments-and-managers">
<h3>Slave Environments and Managers<a class="headerlink" href="#slave-environments-and-managers" title="Permalink to this headline">¶</a></h3>
<p>Each of the slave environments in the <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>
is executed in its own subprocess (see Figure 1.).
As the slave environments are outside the master environment’s
process, their functions cannot be directly called by the master and thus the
slaves require other functionality to accept orders from the master.
To this end, each slave environment is initialized
with a manager agent, <a class="reference internal" href="mp.html#creamas.mp.EnvManager" title="creamas.mp.EnvManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvManager</span></code></a> or its subclass,
which acts as a bridge between external sources and the environment instance itself;
the external source being in most cases the master environment.</p>
<div class="figure align-default" id="id1">
<a class="reference internal image-reference" href="_images/multiprocessing_architecture.svg"><img alt="_images/multiprocessing_architecture.svg" src="_images/multiprocessing_architecture.svg" width="100%" /></a>
<p class="caption"><span class="caption-text">Figure 1. Basic architecture for <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>.
The environment in the main process is used to connect to each slave
environment’s manager and sends commands to them. The managers then forward
the commands to the slave environments which execute them.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If an environment is a slave environment in some
<a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>, then its first agent (the agent in path
<code class="docutils literal notranslate"><span class="pre">tcp://environment-address:port/0</span></code>) is always expected to be an instance of
<a class="reference internal" href="mp.html#creamas.mp.EnvManager" title="creamas.mp.EnvManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvManager</span></code></a>, or a subclass of it.</p>
</div>
</div>
<div class="section" id="managing-functions">
<h3>Managing Functions<a class="headerlink" href="#managing-functions" title="Permalink to this headline">¶</a></h3>
<p>The basic manager implementation contains several exposed
<em>managing functions</em> for the environment’s functions, i.e. functions that call
the underlying environment’s
functions with the same name. These managing functions allow the master to
execute tasks on each of the slave environments, e.g., to collect the addresses
of all the agents in all the environments or trigger <code class="xref py py-meth docutils literal notranslate"><span class="pre">act()</span></code> of each of
these agents.</p>
</div>
<div class="section" id="communication-between-master-and-slaves">
<h3>Communication Between Master and Slaves<a class="headerlink" href="#communication-between-master-and-slaves" title="Permalink to this headline">¶</a></h3>
<p>The communication between the master and the slave environment happens through
<strong>tcp</strong> connection. In principle, the functionality works as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Master environment connects to the slave’s manager.</p></li>
<li><p>Master environment calls slave manager’s exposed method.</p></li>
<li><p>The slave’s manager calls the method with the same name in its environment with the given arguments.</p></li>
<li><p>The slave environment executes the method and returns possible return value.</p></li>
<li><p>The slave manager passes the return value back to the master environment.</p></li>
<li><p>Master environment closes the connection.</p></li>
</ol>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Managers do not check who gives the execution orders by default. When
deploying in open environments, e.g. environments exposed to internet, it
is important that you do not expose any unwanted functionality through them
without adding some safe guards to the exposed functions.</p>
<p>Creamas is mainly developed to be a research tool to be used in closed
environments, and therefore is not particularly designed to offer protection
for any kinds of attacks. However, <a class="reference external" href="https://aiomas.readthedocs.io/en/latest/guides/tls.html">aiomas</a>
has some built-in encryption support for, e.g., TSL. As Creamas’
<a class="reference internal" href="environment.html#creamas.core.environment.Environment" title="creamas.core.environment.Environment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Environment</span></code></a> is just a subclass of aiomas’
<code class="xref py py-class docutils literal notranslate"><span class="pre">Container</span></code>, the TSL support from aiomas can be utilised in Creamas.</p>
</div>
</div>
<div class="section" id="developing-for-multiple-cores">
<h3>Developing for Multiple Cores<a class="headerlink" href="#developing-for-multiple-cores" title="Permalink to this headline">¶</a></h3>
<p>To utilize multiprocessing support in your own implementations, you can give
following initialization parameters to <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Address</strong>: Address for the manager/master environment.</p></li>
<li><p><strong>Environment class</strong>: Class for the manager/master environment
which is used to connect to each of the slave managers.</p></li>
<li><p><strong>Manager class</strong>: Class for the master environment’s manager. This
should not be needed if you are not using <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>
as a part of <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a></p></li>
</ul>
</div></blockquote>
<p>After the master environment has been created, the slave environments can be
spawned using <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment.spawn_slaves" title="creamas.mp.MultiEnvironment.spawn_slaves"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spawn_slaves()</span></code></a>. It accepts
at least the following arguments.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Slave addresses</strong>: Addresses for the slave environments, the size of
this list will define how many subprocesses are spawned.</p></li>
<li><p><strong>Slave environment class</strong>: Class for each slave environment inside the
multiprocessing environment.</p></li>
<li><p><strong>Slave environment parameters</strong>: Initialization parameters for each slave
environment.</p></li>
<li><p><strong>Slave manager class</strong>: This is the manager agent class that is used for
each slave environment.</p></li>
</ul>
</div></blockquote>
<p>You can, of course, also subclass <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> itself
(see <a class="reference internal" href="grid.html#creamas.grid.GridMultiEnvironment" title="creamas.grid.GridMultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridMultiEnvironment</span></code></a> for an example).</p>
</div>
</div>
<div class="section" id="support-for-distributed-systems">
<h2>Support for Distributed Systems<a class="headerlink" href="#support-for-distributed-systems" title="Permalink to this headline">¶</a></h2>
<p>Support for distributed systems in Creamas is built around
<a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a>. Distributed environment is
designed to be used with multiple (quite homogeneous) nodes which operate in
a closed system where each node can make <strong>tcp</strong> connections to ports in
other nodes. Further on, it requires that it is located in a machine that is
able to make SSH connections to the nodes.</p>
<p>The basic architecture of <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a> can
be seen in the Figure 2. In short, <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a> acts
as a master for the whole environment, i.e. it does not hold “actual” simulation
agents, but serves only as a manager for the simulation. Other nodes
in the environment then each contain an instance of
<a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> with its own manager, which accepts orders
from <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a>. The slave environments inside
each <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> then hold the actual agents for the
simulation (and the manager for the slave environment).</p>
<div class="figure align-default" id="id2">
<a class="reference internal image-reference" href="_images/distributed_architecture.svg"><img alt="_images/distributed_architecture.svg" src="_images/distributed_architecture.svg" width="100%" /></a>
<p class="caption"><span class="caption-text">Figure 2. Basic architecture for <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a>.
It manages a set of nodes each containing a <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a>.
The main difference from the single node implementation is, that the main
process environment on each node also holds a manager which accepts commands
for that node.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>Next, we look at how to set up and use <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a>.
In the following, node and <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> are used
interchangeably.</p>
<div class="section" id="using-a-distributed-environment">
<h3>Using a Distributed Environment<a class="headerlink" href="#using-a-distributed-environment" title="Permalink to this headline">¶</a></h3>
<p>Initialization of a distributed environment is done roughly in the following
steps:</p>
<blockquote>
<div><blockquote>
<div><ol class="arabic simple">
<li><p>Initialize <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a> with a list of node locations</p></li>
<li><p>Create node spawning terminal commands for each node, i.e. commands which start <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> on each node.</p></li>
<li><p>Spawn nodes using <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment.spawn_nodes" title="creamas.ds.DistributedEnvironment.spawn_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spawn_nodes()</span></code></a></p></li>
<li><p>Wait until all nodes are <strong>ready</strong> (see, e.g. <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment.is_ready" title="creamas.mp.MultiEnvironment.is_ready"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_ready()</span></code></a>) using <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment.wait_nodes" title="creamas.ds.DistributedEnvironment.wait_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wait_nodes()</span></code></a>. A node is ready when it has finished its own initialization and is ready to execute orders.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Make any additional preparation for the nodes using <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment.prepare_nodes" title="creamas.ds.DistributedEnvironment.prepare_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_nodes()</span></code></a>.</p></li>
</ol>
</div></blockquote>
<p>After this sequence, the <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a> should be
ready to be used. The main usage for iterative simulations is to call
<a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment.trigger_all" title="creamas.ds.DistributedEnvironment.trigger_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trigger_all()</span></code></a>, which triggers all
agents in all the nodes (in all the slave environments) to act.</p>
</div>
<div class="section" id="spawning-nodes">
<h3>Spawning Nodes<a class="headerlink" href="#spawning-nodes" title="Permalink to this headline">¶</a></h3>
<p>When <a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment.spawn_nodes" title="creamas.ds.DistributedEnvironment.spawn_nodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spawn_nodes()</span></code></a> is called,
<a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a> spawns a new process for each node
in the list of node locations given at initialization time. For each process
it does the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>it opens a SSH connection to one of the nodes, and</p></li>
<li><p>executes a command line script on the node.</p></li>
</ol>
</div></blockquote>
<p>The command line script executed is assumed to spawn an instance of
<a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> with a manager attached to it. This
manager is then used to communicate any commands from
<a class="reference internal" href="ds.html#creamas.ds.DistributedEnvironment" title="creamas.ds.DistributedEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistributedEnvironment</span></code></a> to the slave environments on that
node. The command line script can also do other preparation for the node, e.g.
populate its slave environments with agents.</p>
<p>The command line script executed is assumed to wait until the
<a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> is stopped, i.e. it does not exit
after the initialization (as in the naive case this would delete the
environment). To achieve this, you can for example add a following kind of
function to your node spawning script and call it last in the script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">async</span> <span class="k">def</span> <span class="nf">run_node</span><span class="p">(</span><span class="n">menv</span><span class="p">,</span> <span class="n">log_folder</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
            <span class="n">await</span> <span class="n">menv</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">stop_received</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;Execution interrupted by user.&#39;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">await</span> <span class="n">menv</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">log_folder</span><span class="p">,</span> <span class="n">as_coro</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</div>
<p>When <code class="xref py py-func docutils literal notranslate"><span class="pre">run_node()</span></code> is called, the script will block its execution until the
manager of <a class="reference internal" href="mp.html#creamas.mp.MultiEnvironment" title="creamas.mp.MultiEnvironment"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiEnvironment</span></code></a> receives a stop sign. The stop
sign is sent to each node’s manager when <code class="xref py py-meth docutils literal notranslate"><span class="pre">stop_nodes()</span></code>
is called.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">creamas/examples/grid/</span></code> for an example implementation of a distributed
agent environment.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="create_sim.html" class="btn btn-neutral float-left" title="Using Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019, Simo Linkola

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>